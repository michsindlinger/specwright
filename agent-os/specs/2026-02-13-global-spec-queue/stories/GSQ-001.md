# GSQ-001: Backend Queue-Service auf Global umstellen

## User Story
Als Developer möchte ich eine globale Queue haben, die Specs aus verschiedenen Projekten verwalten kann, damit ich projektübergreifend Specs in Reihenfolge ausführen lassen kann.

## Akzeptanzkriterien
- GEGEBEN ein Server mit mehreren offenen Projekten
  WENN ich einen Spec aus Projekt A und einen aus Projekt B zur Queue hinzufüge
  DANN sind beide Items in einer einzigen globalen Queue mit korrektem projectPath

- GEGEBEN eine globale Queue mit Items aus verschiedenen Projekten
  WENN ich die Queue starte
  DANN werden Specs sequenziell ausgeführt, egal aus welchem Projekt

- GEGEBEN eine laufende Queue
  WENN der aktuelle Spec abgeschlossen ist
  DANN wird der nächste pending Spec gestartet mit dem korrekten projectPath

## Technische Details

**Type:** Backend
**Priority:** Critical
**Effort:** M (5 SP)
**Abhängigkeiten:** keine

### WAS
- `queue.service.ts` refactoren: Von `Map<string, QueueState>` zu einzelnem `QueueState`
- `QueueItem` Interface erweitern um `projectPath` und `projectName`
- `queue.handler.ts` anpassen: projectPath aus Message-Payload statt Connection

### WIE
- Service Layer: Singleton QueueService mit globalem State
- QueueItem bekommt projectPath/projectName als Pflichtfelder
- add() erhält projectPath + projectName als Parameter
- start()/stop() arbeiten global (keine projectPath Parameter mehr)
- getNextPending() liefert nächstes Item unabhängig vom Projekt
- Broadcast via WebSocket an ALLE verbundenen Clients
- Handler: projectPath kommt aus Payload der Message, nicht mehr aus Connection-Context

### WO
- `agent-os-ui/src/server/services/queue.service.ts` (modify)
- `agent-os-ui/src/server/handlers/queue.handler.ts` (modify)

### Geschätzte Komplexität: M

## DoR Checkliste
- [x] Fachliche Requirements klar
- [x] Akzeptanzkriterien spezifisch und testbar
- [x] Technischer Ansatz definiert (WAS/WIE/WO)
- [x] Abhängigkeiten identifiziert
- [x] Story angemessen dimensioniert
- [x] Alle betroffenen Layer identifiziert (Service)
- [x] Integrationspunkte dokumentiert

## DoD Checkliste
- [x] Code kompiliert ohne Fehler
- [x] Tests passen
- [x] Linter passt
- [x] Kein `any` Types
- [x] Unit Tests für QueueService Refactoring
- [x] Broadcast an alle Clients verifiziert
- [x] Self-Review completed
